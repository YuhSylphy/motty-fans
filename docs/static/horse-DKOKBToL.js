import{j as $,S as j,c as E,o as d,k as U,l as k,e as A,O as M,h as x,m as B}from"./store-CbeowOQZ.js";import{o as H}from"./of-BU7p89mu.js";import{t as F}from"./tap-BulvHVcV.js";var O=$(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function C(e,n){return new Promise(function(a,t){var i=new j({next:function(s){a(s),i.unsubscribe()},error:t,complete:function(){t(new O)}});e.subscribe(i)})}function G(e,n,a,t,i){return function(s,r){var o=a,u=n,v=0;s.subscribe(E(r,function(m){var b=v++;u=o?e(u,m,b):(o=!0,m)},function(){o&&r.next(u),r.complete()}))}}function y(e,n){return d(G(e,n,arguments.length>=2,!1,!0))}var I=function(e,n){return e.push(n),e};function P(){return d(function(e,n){y(I,[])(e).subscribe(n)})}function R(e,n,a,t){return d(function(i,s){var r;(!n||typeof n=="function")&&(r=n);var o=new Map,u=function(l){o.forEach(l),l(s)},v=function(l){return u(function(f){return f.error(l)})},m=0,b=!1,h=new U(s,function(l){try{var f=e(l),c=o.get(f);if(!c){o.set(f,c=t?t():new k);var w=S(f,c);if(s.next(w),a){var p=E(c,function(){c.complete(),p==null||p.unsubscribe()},void 0,void 0,function(){return o.delete(f)});h.add(A(a(w)).subscribe(p))}}c.next(r?r(l):l)}catch(g){v(g)}},function(){return u(function(l){return l.complete()})},v,function(){return o.clear()},function(){return b=!0,m===0});i.subscribe(h);function S(l,f){var c=new M(function(w){m++;var p=f.subscribe(w);return function(){p.unsubscribe(),--m===0&&b&&h.unsubscribe()}});return c.key=l,c}})}const J={Uk:{label:"不明(指定なし)"},Ec:{label:"エクリプス"},Ph:{label:"ファラリス"},Ns:{label:"ナスルーラ"},Ro:{label:"ロイヤルチャージャー"},Ne:{label:"ニアークティック"},Na:{label:"ネイティヴダンサー"},Fa:{label:"フェアウェイ"},To:{label:"トムフール"},Te:{label:"テディ"},Sw:{label:"スインフォード"},Ha:{label:"ハンプトン"},Hi:{label:"ヒムヤー"},St:{label:"セントサイモン"},Ma:{label:"マッチェム"},He:{label:"ヘロド"}},N=(e,{sex:n,listed:a,childName:t})=>{var m,b,h;const i=e.name??`${t}${n==="female"?"母":n==="male"?"父":"親"}`,s=e.name!==void 0,r=e.father?N(e.father,{sex:"male",childName:i}):[],o=e.mother?N(e.mother,{sex:"female",childName:i}):[],u=e.line??((m=r==null?void 0:r[0])==null?void 0:m.line)??"Uk";return[{name:i,line:u,listed:!!a,owned:!1,show:s,fatherName:(b=r==null?void 0:r[0])==null?void 0:b.name,motherName:(h=o==null?void 0:o[0])==null?void 0:h.name,memo:[],sex:n},r,o].flat()},T=()=>fetch("/motty-fans//assets/horse-defs.json").then(e=>e.json()).then(e=>e.filter(n=>!n.removed).map(n=>({...n,listed:!!n.listed,owned:!0,show:!0,memo:n.memo??[]}))),q=()=>fetch("/motty-fans//assets/broodmares.json").then(e=>e.json()).then(e=>e.map(n=>N(n,{sex:"female",listed:!0,childName:"N/A"})).flat()),D=()=>fetch("/motty-fans//assets/stallions.json").then(e=>e.json()).then(e=>e.map(n=>N(n,{sex:"male",listed:!0,childName:"N/A"})).flat()),K=()=>C(H(T,D,q).pipe(x(e=>e()),B(),R(e=>e.name),x(e=>e.pipe(y((n,a)=>({name:n.name??a.name,sex:n.sex??a.sex,listed:n.listed||a.listed,show:n.show||a.show,owned:n.owned||a.owned,line:n.line==="Uk"?a.line:n.line,memo:[...n.memo,...a.memo],fatherName:n.fatherName??a.fatherName,motherName:n.motherName??a.motherName})))),P(),F(e=>{const n=new Map(e.map(t=>[t.name,t])),a=t=>{var i;if(!(t.line&&t.line!=="Uk")){if(t.fatherName){const s=n.get(t.fatherName);s?a(s):console.warn(`${t.fatherName}: father of ${t.name} doesnt exist in list`,t,n)}t.line=((i=n.get(t.fatherName||""))==null?void 0:i.line)??"Uk",t.line==="Uk"&&console.warn(`couldnt determine line of ${t.name}`)}};e.forEach(a)})));export{K as f,J as l};
