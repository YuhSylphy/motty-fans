import{A as $,t as F,o as W,c as z,u as j,b as U,v as O,r as V}from"./store-BRF7tp6L.js";import{r as h,j as e,R as I}from"./jsx-runtime-_5WuVDLK.js";import{I as N,u as w}from"./index-CmoejEWL.js";import{C as M,a as G}from"./Profile-DvPGfU8E.js";import{i as Y,k as J,j as y,u as Q,_ as q,b as S,c as K,h as X}from"./DefaultPropsProvider-CSjmKMGg.js";import{P as L}from"./Paper-CR0QuJQc.js";import{C as Z}from"./Container-C-BfI4Bx.js";import{T as ee,G as m}from"./base-_RRlrjJu.js";import{c as H}from"./menu-defs-CspXl_hk.js";import{u as te,a as R}from"./hooks-DVGqdmTD.js";import{a as se}from"./List-Bzz6kMxx.js";import{T as ne,D as ie,a as re,b as oe,c as k,d as p,e as le,A as ae,L as ce}from"./TableRow-CK9a4Eab.js";import{T as c,L as de}from"./ListItem-CO4yw9-0.js";import{I as ue}from"./IconButton--QJhXQVt.js";import{B as he}from"./Box-DH0NNVFk.js";import{L as me}from"./Link-BMnGLxO3.js";import{f as pe}from"./liveSeries-D1-Gknr6.js";import{D as xe}from"./datetime-BT3pVNmC.js";import{f as T,w as A}from"./util-DTrBjrrl.js";import"./redux-toolkit.modern-J4jBE5Lh.js";import"./ducks-B4GhlEk-.js";import"./useFormControl-CkXjXPAx.js";import"./useTheme-BXk4qgwv.js";import"./useThemeProps-DPnKjH86.js";import"./resolveComponentProps-LjkoubKo.js";import"./createBox-gRr0yNN2.js";import"./TransitionGroupContext-OigCRaz6.js";import"./utils-Ds4Qqy87.js";import"./index-CTAOeIM6.js";import"./useSlotProps-BWWNHuKW.js";import"./Modal-x9pmWsIV.js";import"./Backdrop-Diuy1ohG.js";import"./GlobalStyles-CG4ksUWf.js";import"./pako.esm-BoIYYwlZ.js";import"./of-BHGPBNzS.js";var je=new $(F);function fe(s,t){return t===void 0&&(t=je),W(function(n,r){var l=null,a=null,o=null,i=function(){if(l){l.unsubscribe(),l=null;var u=a;a=null,r.next(u)}};function d(){var u=o+s,x=t.now();if(x<u){l=this.schedule(void 0,u-x),r.add(l);return}i()}n.subscribe(z(r,function(u){a=u,o=t.now(),l||(l=t.schedule(d,s),r.add(l))},function(){i(),r.complete()},void 0,function(){a=l=null}))})}function ve(s){return Y("MuiTableHead",s)}J("MuiTableHead",["root"]);const be=["className","component"],ge=s=>{const{classes:t}=s;return X({root:["root"]},ve,t)},ye=y("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(s,t)=>t.root})({display:"table-header-group"}),Le={variant:"head"},C="thead",Te=h.forwardRef(function(t,n){const r=Q({props:t,name:"MuiTableHead"}),{className:l,component:a=C}=r,o=q(r,be),i=S({},r,{component:a}),d=ge(i);return e.jsx(ne.Provider,{value:Le,children:e.jsx(ye,S({as:a,className:K(d.root,l),ref:n,role:a===C?null:"rowgroup",ownerState:i},o))})}),Se=H(e.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"}),"Link"),Ce=H(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),Ie=["video","broadcast","short"];function we(s){return!!s&&Ie.includes(s)}function Me(s){if(!we(s))return null;switch(s){case"video":return"動画";case"broadcast":return"生配信";case"short":return"ショート";default:throw Error(s)}}function B(){return e.jsx("div",{children:"Loading..."})}const D=s=>["★".repeat(s),"☆".repeat(5-s)].join("").trim(),He=y("img")(s=>({objectFit:"cover"}));function E({thumbnail:{url:s,width:t,height:n},href:r,alt:l}){const a=w({xs:i=>({maxHeight:i.spacing(9)}),sm:i=>({maxHeight:i.spacing(9)}),md:i=>({maxHeight:i.spacing(6)}),lg:i=>({maxHeight:i.spacing(6)}),xl:i=>({maxHeight:i.spacing(6)})}),o=h.useMemo(()=>`${t} / ${n}`,[t,n]);return e.jsx(me,{href:r,sx:i=>({width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",alignContent:"center",...a(i)}),target:"_blank",rel:"noopener noreferrer",children:e.jsx(He,{sx:{aspectRatio:o},alt:l,src:s})})}function P(s){const t=s.map(Me);switch(t.length){case 0:return null;case 1:return t[0];default:return t.map(n=>n==null?void 0:n.slice(0,1)).join(" / ")}}const Re=({styles:s,masteryLevel:t,part1:n,href:r})=>{const l=h.useMemo(()=>P(s),[s]),a=h.useMemo(()=>D(t),[t]),o=r!==null?{href:r,target:"_blank",rel:"noopener noreferrer"}:n!==null&&n.url!=null?{href:n.url,target:"_blank",rel:"noopener noreferrer"}:{};return{liveStyleLabel:l,masteryLevelLabel:a,iconButtonAdditionalProps:o}};function ke({id:s,platform:t,title:n,titleReleasedIn:r,styles:l,amount:a,masteryLevel:o,part1:i,remarks:d,href:u}){const{liveStyleLabel:x,masteryLevelLabel:v,iconButtonAdditionalProps:f}=Re({styles:l,masteryLevel:o,part1:i,href:u}),b=h.useCallback(()=>e.jsxs(m,{container:!0,children:[e.jsx(m,{item:!0,xs:6,children:e.jsx(c,{children:x})}),e.jsx(m,{item:!0,xs:6,children:e.jsx(c,{children:v})}),e.jsx(m,{item:!0,xs:6,children:e.jsx(c,{children:t})}),e.jsx(m,{item:!0,xs:6,children:e.jsxs(c,{children:["実況: ",(i==null?void 0:i.publishedIn)??"(未設定)"]})}),e.jsx(m,{item:!0,xs:6,children:e.jsxs(c,{children:["配信数: ",a]})}),e.jsx(m,{item:!0,xs:6,children:e.jsxs(c,{children:["発売: ",r??"(未設定)"]})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(c,{children:d})})]}),[x,v,t,i==null?void 0:i.publishedIn,a,r,d]);return e.jsx(de,{secondaryAction:e.jsx(ue,{edge:"end",...f,children:e.jsx(Se,{})}),children:e.jsxs(m,{container:!0,children:[e.jsx(m,{item:!0,xs:12,children:e.jsx(ce,{primary:n})}),e.jsx(m,{item:!0,xs:4,children:i==null||!f.href?e.jsx(he,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:e.jsx(c,{children:"(未設定)"})}):e.jsx(E,{thumbnail:i.thumbnail,alt:i.title,...f})}),e.jsx(m,{item:!0,xs:8,children:e.jsx(b,{})})]})},s)}function Ae({defs:s}){return e.jsx(L,{children:e.jsx(se,{sx:{width:"100%"},children:s.map(ke).flatMap((t,n)=>n===0?[t]:[e.jsx(ie,{variant:"inset",component:"li",sx:{marginLeft:0}},`divider-${n}`),t])})})}function Be({id:s,platform:t,title:n,titleReleasedIn:r,styles:l,amount:a,masteryLevel:o,part1:i,remarks:d,href:u},x){const v=h.useMemo(()=>P(l),[l]),f=h.useCallback(()=>i?e.jsx(p,{align:"center",sx:b=>({padding:`${b.spacing(.5)} ${b.spacing(2)}`}),children:e.jsx(E,{thumbnail:i.thumbnail,alt:n,href:u||i.url})}):e.jsx(p,{align:"center",children:e.jsx(c,{children:"(未設定)"})}),[i,n,u]);return e.jsxs(k,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(p,{component:"th",scope:"row",align:"center",children:e.jsx(c,{children:x+1})}),e.jsx(f,{}),e.jsx(p,{align:"center",children:e.jsx(c,{children:t})}),e.jsx(p,{children:e.jsx(c,{children:n})}),e.jsx(p,{align:"center",children:e.jsx(c,{children:(i==null?void 0:i.publishedIn)??"(未設定)"})}),e.jsx(p,{align:"center",children:e.jsx(c,{children:r??"(未設定)"})}),e.jsx(p,{align:"center",children:e.jsx(c,{children:v})}),e.jsx(p,{align:"center",children:e.jsx(c,{children:a})}),e.jsx(p,{align:"center",children:e.jsx(c,{children:D(o)})}),e.jsx(p,{children:e.jsx(c,{children:d})})]},s)}function De({defs:s}){return e.jsx(re,{component:L,children:e.jsxs(oe,{"aria-label":"simple table",children:[e.jsx(Te,{children:e.jsx(k,{children:["#","Part 1.","機種","タイトル","実況年","発売年","実況形式","実況本数","やりこみ評価","備考"].map((t,n)=>e.jsx(p,{component:"th",scope:"row",align:"center",children:t},n))})}),e.jsx(le,{children:s.map(Be)})]})})}function Ee(){return e.jsx(ae,{position:"static",color:"primary",enableColorOnDark:!0,children:e.jsx(c,{variant:"subtitle1",children:"MOTTYのゲーム実況シリーズ一覧"})})}const Pe=()=>{const{displayRecords:s}=R(n=>n.liveSeries);return{viewMode:w({xs:"list",sm:"list",md:"table",lg:"table",xl:"table"}),defs:s}};function _e({conditionTextInput:s}){h.useEffect(()=>{console.debug(`input: ${s}`)},[s]);const{viewMode:t,defs:n}=Pe(),r=h.useCallback(()=>{switch(t){case"list":return e.jsx(Ae,{defs:n});case"table":return e.jsx(De,{defs:n});default:throw t}},[t,n]);return e.jsxs(I.Fragment,{children:[e.jsx(Ee,{}),e.jsx(r,{})]})}const $e=y(L)(({theme:s})=>({marginTop:s.spacing(1),marginBottom:s.spacing(1),padding:s.spacing(1)}));function Fe(){return e.jsx(M,{children:e.jsx(G,{})})}function We(){return e.jsx(M,{children:e.jsx(c,{variant:"subtitle1",children:"MOTTYのゲーム実況作品一覧 & 検索ページ (仮)"})})}function ze({conditionTextInput:s,updateTextInput:t}){return e.jsx(Z,{children:e.jsxs($e,{children:[e.jsx(Fe,{}),e.jsx(We,{}),e.jsx(ee,{id:"live-series-condition-input",label:"find",InputProps:{startAdornment:e.jsx(N,{position:"start",children:e.jsx(Ce,{})})},variant:"standard",fullWidth:!0,value:s,onChange:t,placeholder:"検索ワード (ゲームタイトル、ゲーム機など)",autoFocus:!0})]})})}const Ue=()=>{const[s,t]=h.useState(!1),n=te();h.useEffect(()=>{s||(n(j.init()),t(!0))},[s,t,n]);const[r,l]=h.useState(""),a=h.useCallback(({target:{value:d}})=>{l(d),n(j.setConditionText({conditionText:d}))},[n]),{records:o}=R(d=>d.liveSeries);return{loading:h.useMemo(()=>!o||o.length===0,[o]),conditionTextInput:r,updateTextInput:a}};function Oe(){const{loading:s,conditionTextInput:t,updateTextInput:n}=Ue();return s?e.jsx(B,{}):e.jsxs(I.Fragment,{children:[e.jsx(ze,{conditionTextInput:t,updateTextInput:n}),e.jsx(_e,{conditionTextInput:t})]})}function kt(){return e.jsx(h.Suspense,{fallback:e.jsx(B,{}),children:e.jsx(Oe,{})})}const Ve=({id:s,game:t,seriesTitle:n,lives:r,remarks:l,videosHash:a})=>({id:s,platform:t==null?void 0:t.platform,title:n,titleReleasedIn:(t==null?void 0:t.releasedIn)||null,styles:(o=>Array.from(o))(r.map(({liveStyle:o})=>o).reduce((o,i)=>o.add(i),new Set)),amount:r.length,masteryLevel:t==null?void 0:t.masteryLevel,part1:r.length===0?null:r.slice(0,1).map(({publishedAt:o,url:i,thumbnail:d,title:u})=>({publishedIn:xe.fromMillis(o,{zone:"JST"}).year,url:i,thumbnail:d,title:u}))[0],remarks:l,href:a?`/motty-fans/videos/${a}`:null}),Ne=s=>s.pipe(T(j.init.match),A("live-series/init",async()=>{const n=(await pe()).map(Ve);return j.setRecords({records:n})})),Ge=s=>s.pipe(T(j.setRecords.match),O(({payload:{records:t}})=>j.setDisplayRecords({displayRecords:t}))),Ye=250,Je=(s,t)=>s.pipe(T(j.setConditionText.match),fe(Ye),A("filterWithConditionEpic",async({payload:{conditionText:n}})=>{const{value:{liveSeries:{records:r}}}=t,l=(()=>{if(!n)return r;const a=n.split(" ").map(o=>o.trim()).filter(o=>o!=="");return r.filter(({amount:o,href:i,id:d,platform:u,remarks:x,styles:v,title:f,titleReleasedIn:b})=>a.includes(`${o}`)||a.includes(`${b}`)||[i,d,u,x,...v,f].some(g=>a.some(_=>g==null?void 0:g.includes(_))))})();return j.setDisplayRecords({displayRecords:l})})),Qe=U(Ne,Ge,Je);V(Qe);export{kt as default};
