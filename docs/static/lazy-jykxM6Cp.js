import{A as J,t as F,o as V,c as W,u as f,d as z,v as O,s as U}from"./store-CbeowOQZ.js";import{r as u,j as e,R as C}from"./jsx-runtime-_5WuVDLK.js";import{I as G,u as I,f as N,a as Q,b as Y,d as q}from"./base-Dytjuklp.js";import{i as K,k as X,j as y,u as Z,_ as ee,b as T,c as se,h as te}from"./DefaultPropsProvider-CSjmKMGg.js";import{P as L}from"./Paper-CR0QuJQc.js";import{C as ne}from"./Container-C-BfI4Bx.js";import{T as ie,G as h}from"./TextField-BKHQXlXv.js";import{c as M}from"./menu-defs-M7zDA-F1.js";import{u as H,a as R}from"./hooks-DVGqdmTD.js";import{a as re}from"./List-Bzz6kMxx.js";import{T as oe,D as ae,a as le,b as ce,c as k,d as p,e as de,A as ue,L as me}from"./TableRow-CK9a4Eab.js";import{T as c,L as he}from"./ListItem-CO4yw9-0.js";import{I as pe}from"./IconButton--QJhXQVt.js";import{B as xe}from"./Box-DH0NNVFk.js";import{L as fe}from"./Link-BMnGLxO3.js";import{D as A}from"./datetime-BT3pVNmC.js";import"./pako.esm-BoIYYwlZ.js";import{f as S,w as D}from"./util-fbA-A0iJ.js";import"./redux-toolkit.modern-J4jBE5Lh.js";import"./ducks-B4GhlEk-.js";import"./useFormControl-CkXjXPAx.js";import"./useTheme-BXk4qgwv.js";import"./useThemeProps-DPnKjH86.js";import"./resolveComponentProps-LjkoubKo.js";import"./utils-Ds4Qqy87.js";import"./TransitionGroupContext-OigCRaz6.js";import"./index-CTAOeIM6.js";import"./useSlotProps-BWWNHuKW.js";import"./Modal-x9pmWsIV.js";import"./Backdrop-Diuy1ohG.js";import"./GlobalStyles-CG4ksUWf.js";import"./createBox-gRr0yNN2.js";import"./of-BU7p89mu.js";var je=new J(F);function ve(s,t){return t===void 0&&(t=je),V(function(i,n){var o=null,a=null,l=null,r=function(){if(o){o.unsubscribe(),o=null;var d=a;a=null,n.next(d)}};function m(){var d=l+s,x=t.now();if(x<d){o=this.schedule(void 0,d-x),n.add(o);return}r()}i.subscribe(W(n,function(d){a=d,l=t.now(),o||(o=t.schedule(m,s),n.add(o))},function(){r(),n.complete()},void 0,function(){a=o=null}))})}function be(s){return K("MuiTableHead",s)}X("MuiTableHead",["root"]);const ge=["className","component"],ye=s=>{const{classes:t}=s;return te({root:["root"]},be,t)},Le=y("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(s,t)=>t.root})({display:"table-header-group"}),Se={variant:"head"},w="thead",Te=u.forwardRef(function(t,i){const n=Z({props:t,name:"MuiTableHead"}),{className:o,component:a=w}=n,l=ee(n,ge),r=T({},n,{component:a}),m=ye(r);return e.jsx(oe.Provider,{value:Se,children:e.jsx(Le,T({as:a,className:se(m.root,o),ref:i,role:a===w?null:"rowgroup",ownerState:r},l))})}),we=M(e.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"}),"Link"),Ce=M(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),Ie=["video","broadcast","short"];function Me(s){return!!s&&Ie.includes(s)}function He(s){if(!Me(s))return null;switch(s){case"video":return"動画";case"broadcast":return"生配信";case"short":return"ショート";default:throw Error(s)}}function B(){return e.jsx("div",{children:"Loading..."})}const _=s=>["★".repeat(s),"☆".repeat(5-s)].join("").trim(),Re=y("img")(s=>({objectFit:"cover"}));function E({thumbnail:{url:s,width:t,height:i},href:n,alt:o}){const a=I({xs:r=>({maxHeight:r.spacing(9)}),sm:r=>({maxHeight:r.spacing(9)}),md:r=>({maxHeight:r.spacing(6)}),lg:r=>({maxHeight:r.spacing(6)}),xl:r=>({maxHeight:r.spacing(6)})}),l=u.useMemo(()=>`${t} / ${i}`,[t,i]);return e.jsx(fe,{href:n,sx:r=>({width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",alignContent:"center",...a(r)}),target:"_blank",rel:"noopener noreferrer",children:e.jsx(Re,{sx:{aspectRatio:l},alt:o,src:s})})}function P(s){const t=s.map(He);switch(t.length){case 0:return null;case 1:return t[0];default:return t.map(i=>i==null?void 0:i.slice(0,1)).join(" / ")}}const ke=({styles:s,masteryLevel:t,part1:i,href:n})=>{const o=u.useMemo(()=>P(s),[s]),a=u.useMemo(()=>_(t),[t]),l=n!==null?{href:n,target:"_blank",rel:"noopener noreferrer"}:i!==null&&i.url!=null?{href:i.url,target:"_blank",rel:"noopener noreferrer"}:{};return{liveStyleLabel:o,masteryLevelLabel:a,iconButtonAdditionalProps:l}};function Ae({id:s,platform:t,title:i,titleReleasedIn:n,styles:o,amount:a,masteryLevel:l,part1:r,remarks:m,href:d}){const{liveStyleLabel:x,masteryLevelLabel:v,iconButtonAdditionalProps:j}=ke({styles:o,masteryLevel:l,part1:r,href:d}),b=u.useCallback(()=>e.jsxs(h,{container:!0,children:[e.jsx(h,{item:!0,xs:6,children:e.jsx(c,{children:x})}),e.jsx(h,{item:!0,xs:6,children:e.jsx(c,{children:v})}),e.jsx(h,{item:!0,xs:6,children:e.jsx(c,{children:t})}),e.jsx(h,{item:!0,xs:6,children:e.jsxs(c,{children:["実況: ",(r==null?void 0:r.publishedIn)??"(未設定)"]})}),e.jsx(h,{item:!0,xs:6,children:e.jsxs(c,{children:["配信数: ",a]})}),e.jsx(h,{item:!0,xs:6,children:e.jsxs(c,{children:["発売: ",n??"(未設定)"]})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(c,{children:m})})]}),[x,v,t,r==null?void 0:r.publishedIn,a,n,m]);return e.jsx(he,{secondaryAction:e.jsx(pe,{edge:"end",...j,children:e.jsx(we,{})}),children:e.jsxs(h,{container:!0,children:[e.jsx(h,{item:!0,xs:12,children:e.jsx(me,{primary:i})}),e.jsx(h,{item:!0,xs:4,children:r==null||!j.href?e.jsx(xe,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:e.jsx(c,{children:"(未設定)"})}):e.jsx(E,{thumbnail:r.thumbnail,alt:r.title,...j})}),e.jsx(h,{item:!0,xs:8,children:e.jsx(b,{})})]})},s)}function De({defs:s}){return e.jsx(L,{children:e.jsx(re,{sx:{width:"100%"},children:s.map(Ae).flatMap((t,i)=>i===0?[t]:[e.jsx(ae,{variant:"inset",component:"li",sx:{marginLeft:0}},`divider-${i}`),t])})})}function Be({id:s,platform:t,title:i,titleReleasedIn:n,styles:o,amount:a,masteryLevel:l,part1:r,remarks:m,href:d},x){const v=u.useMemo(()=>P(o),[o]),j=u.useCallback(()=>r?e.jsx(p,{align:"center",sx:b=>({padding:`${b.spacing(.5)} ${b.spacing(2)}`}),children:e.jsx(E,{thumbnail:r.thumbnail,alt:i,href:d||r.url})}):e.jsx(p,{align:"center",children:e.jsx(c,{children:"(未設定)"})}),[r,i,d]);return e.jsxs(k,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(p,{component:"th",scope:"row",align:"center",children:e.jsx(c,{children:x+1})}),e.jsx(j,{}),e.jsx(p,{align:"center",children:e.jsx(c,{children:t})}),e.jsx(p,{children:e.jsx(c,{children:i})}),e.jsx(p,{align:"center",children:e.jsx(c,{children:(r==null?void 0:r.publishedIn)??"(未設定)"})}),e.jsx(p,{align:"center",children:e.jsx(c,{children:n??"(未設定)"})}),e.jsx(p,{align:"center",children:e.jsx(c,{children:v})}),e.jsx(p,{align:"center",children:e.jsx(c,{children:a})}),e.jsx(p,{align:"center",children:e.jsx(c,{children:_(l)})}),e.jsx(p,{children:e.jsx(c,{children:m})})]},s)}function _e({defs:s}){return e.jsx(le,{component:L,children:e.jsxs(ce,{"aria-label":"simple table",children:[e.jsx(Te,{children:e.jsx(k,{children:["#","Part 1.","機種","タイトル","実況年","発売年","実況形式","実況本数","やりこみ評価","備考"].map((t,i)=>e.jsx(p,{component:"th",scope:"row",align:"center",children:t},i))})}),e.jsx(de,{children:s.map(Be)})]})})}function Ee(){return e.jsx(ue,{position:"static",color:"primary",enableColorOnDark:!0,children:e.jsx(c,{variant:"subtitle1",children:"MOTTYのゲーム実況シリーズ一覧"})})}const Pe=()=>{const{displayRecords:s}=R(i=>i.liveSeries);return{viewMode:I({xs:"list",sm:"list",md:"table",lg:"table",xl:"table"}),defs:s}};function $e(){const{viewMode:s,defs:t}=Pe(),i=u.useCallback(()=>{switch(s){case"list":return e.jsx(De,{defs:t});case"table":return e.jsx(_e,{defs:t});default:throw s}},[s,t]);return e.jsxs(C.Fragment,{children:[e.jsx(Ee,{}),e.jsx(i,{})]})}const Je=y(L)(({theme:s})=>({marginTop:s.spacing(1),marginBottom:s.spacing(1),padding:s.spacing(1)})),Fe=()=>{const s=H(),[t,i]=u.useState(""),n=u.useCallback(({target:{value:o}})=>{i(o),s(f.setConditionText({conditionText:o}))},[s]);return{conditionTextInput:t,updateTextInput:n}};function Ve(){const{conditionTextInput:s,updateTextInput:t}=Fe();return e.jsx(ne,{children:e.jsx(Je,{children:e.jsx(ie,{id:"live-series-condition-input",label:"find",InputProps:{startAdornment:e.jsx(G,{position:"start",children:e.jsx(Ce,{})})},variant:"standard",fullWidth:!0,value:s,onChange:t})})})}const We=()=>{const[s,t]=u.useState(!1),i=H();u.useEffect(()=>{s||(i(f.init()),t(!0))},[s,t,i]);const{records:n}=R(a=>a.liveSeries);return{loading:u.useMemo(()=>!n||n.length===0,[n])}};function ze(){const{loading:s}=We();return s?e.jsx(B,{}):e.jsxs(C.Fragment,{children:[e.jsx(Ve,{}),e.jsx($e,{})]})}function ks(){return e.jsx(u.Suspense,{fallback:e.jsx(B,{}),children:e.jsx(ze,{})})}const Oe=({id:{videoId:s},snippet:{description:t,publishedAt:i,title:n,thumbnails:o},liveSeriesId:a,liveStyle:l,tags:r},m,d)=>({id:s,description:t,publishedAt:A.fromISO(i).toMillis(),title:n,thumbnail:o.default,liveSeriesId:a,liveStyle:l,tags:(r==null?void 0:r.map(q("none")))??[],url:`https://www.youtube.com/watch?v=${s}`});async function Ue(){const[s,t,i]=await Promise.all([(async()=>{const n=await N();return Object.groupBy(n.items.filter(({liveSeriesId:o})=>o!=null).map(Oe),({liveSeriesId:o})=>o??(()=>{throw new Error("unexpected video record having no live-series id")})())})(),(async()=>(await Q()).items)(),(async()=>{const n=await Y();return new Map(n.items.map(o=>[o.id,o]))})()]);return t.map(n=>({...n,lives:n.id in s?s[n.id]??[]:[],game:n.gameId&&i.has(n.gameId)?i.get(n.gameId)??null:null}))}const Ge=({id:s,game:t,seriesTitle:i,lives:n,remarks:o,videosHash:a})=>({id:s,platform:t==null?void 0:t.platform,title:i,titleReleasedIn:(t==null?void 0:t.releasedIn)||null,styles:(l=>Array.from(l))(n.map(({liveStyle:l})=>l).reduce((l,r)=>l.add(r),new Set)),amount:n.length,masteryLevel:t==null?void 0:t.masteryLevel,part1:n.length===0?null:n.slice(0,1).map(({publishedAt:l,url:r,thumbnail:m,title:d})=>({publishedIn:A.fromMillis(l,{zone:"JST"}).year,url:r,thumbnail:m,title:d}))[0],remarks:o,href:a?`/motty-fans/videos/${a}`:null}),Ne=s=>s.pipe(S(f.init.match),D("live-series/init",async()=>{const i=(await Ue()).map(Ge);return f.setRecords({records:i})})),Qe=s=>s.pipe(S(f.setRecords.match),O(({payload:{records:t}})=>f.setDisplayRecords({displayRecords:t}))),Ye=250,qe=(s,t)=>s.pipe(S(f.setConditionText.match),ve(Ye),D("filterWithConditionEpic",async({payload:{conditionText:i}})=>{const{value:{liveSeries:{records:n}}}=t,o=(()=>{if(!i)return n;const a=i.split(" ").map(l=>l.trim()).filter(l=>l!=="");return n.filter(({amount:l,href:r,id:m,platform:d,remarks:x,styles:v,title:j,titleReleasedIn:b})=>a.includes(`${l}`)||a.includes(`${b}`)||[r,m,d,x,...v,j].some(g=>a.some($=>g==null?void 0:g.includes($))))})();return f.setDisplayRecords({displayRecords:o})})),Ke=z(Ne,Qe,qe);U(Ke);export{ks as default};
