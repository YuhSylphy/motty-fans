"use strict";(self.webpackChunkmotty_fans=self.webpackChunkmotty_fans||[]).push([[905],{10381:function(t,n,e){e.r(n),e.d(n,{default:function(){return at}});var r=e(35630),i=e(31303),a=e(50678),o=e(18489),s=e(72791),u=e(20890),l=e(66809),c=e(36151),d=e(72363),f=e(66647),h=e(42169),g=e(81918),p=e(57621),m=e(39504),v=e(26445),x=e(61889),Z=e(10703),b=e(82338),j=e(92343),C=e(47630),y=e(5403),k=e(73700),w=e(69632),T=e(69870),M=e(14771),P=e(52791),A=e(59468),I=e(80184),S=function(t){return"https://www.youtube.com/watch?v=".concat(t)};function D(){return(0,I.jsx)("div",{children:"Loading..."})}var F=(0,C.ZP)(u.Z)({display:"-webkit-box",overflow:"hidden",lineClamp:2,WebkitLineClamp:2,boxOrient:"vertical",WebkitBoxOrient:"vertical",fontSize:".9rem"});function O(t){var n;return(0,I.jsx)(l.Z,{title:null!==(n=t.children)&&void 0!==n?n:"",children:(0,I.jsx)(F,(0,o.Z)((0,o.Z)({},t),{},{gutterBottom:!0,variant:"h6"}))})}function L(t){var n;return(0,I.jsx)(l.Z,{title:null!==(n=t.children)&&void 0!==n?n:"",children:(0,I.jsx)(u.Z,(0,o.Z)((0,o.Z)({},t),{},{variant:"body2",color:"text.secondary",align:"right"}))})}var B=(0,C.ZP)(u.Z)({display:"-webkit-box",overflow:"hidden",lineClamp:3,WebkitLineClamp:3,boxOrient:"vertical",WebkitBoxOrient:"vertical",fontSize:".75rem"});function W(t){var n;return(0,I.jsx)(l.Z,{title:null!==(n=t.children)&&void 0!==n?n:"",children:(0,I.jsx)(B,(0,o.Z)((0,o.Z)({},t),{},{variant:"body2"}))})}function z(t){var n=t.videoId;return(0,I.jsx)(c.Z,{href:S(n),target:"_blank",referrerPolicy:"no-referrer",children:"Watch"})}var _=(0,C.ZP)(d.Z)({justifyContent:"right"});function H(t){var n=t.imageUrl,e=t.alt,r=t.videoId;return(0,I.jsx)(f.Z,{href:S(r),target:"_blank",referrerPolicy:"no-referrer",children:(0,I.jsx)(h.Z,{component:"img",src:n,alt:e})})}function V(t){var n=t.tag,e=t.deletable,r=t.findable,i=function(t,n,e){var r=(0,w.TL)(),i=(0,s.useCallback)((function(){r(T.g.addConditionTags([t]))}),[t]),a=(0,s.useCallback)((function(){r(T.g.removeConditionTags([t]))}),[t]);return{findTag:e?i:void 0,deleteTag:n?a:void 0}}(n,e,r),a=i.findTag,o=i.deleteTag;return(0,I.jsx)(G,{label:n,size:"small",icon:r?(0,I.jsx)(y.Z,{}):void 0,clickable:r,onClick:a,onDelete:o})}var E=(0,C.ZP)(P.Z)({}),G=(0,C.ZP)(g.Z)({fontSize:".4rem"});function N(t){var n=t.tags,e=t.deletable,r=t.findable;return(0,I.jsx)(E,{children:n.map((function(t){return(0,I.jsx)(V,{tag:t,deletable:e,findable:r},t)}))})}var U=(0,C.ZP)("div")((function(t){var n=t.theme;return{height:"0px",width:"100%",margin:"".concat(n.spacing(1)," 0")}}));function q(t){var n=t.def,e=n.thumbnails.high,r=(0,s.useMemo)((function(){return k.ou.fromMillis(n.publishedAt).setZone("Asia/Tokyo").toFormat("yyyy-MM-dd HH:mm:ss")}),[n.publishedAt]);return(0,I.jsxs)(p.Z,{children:[(0,I.jsx)(H,{imageUrl:e.url,alt:n.title,videoId:n.id}),(0,I.jsxs)(m.Z,{children:[(0,I.jsx)(N,{tags:n.tags,findable:!0}),(0,I.jsx)(U,{}),(0,I.jsx)(O,{children:n.title}),(0,I.jsx)(L,{children:r}),(0,I.jsx)(W,{children:n.description})]}),(0,I.jsx)(_,{children:(0,I.jsx)(z,{videoId:n.id})})]})}function J(t){var n=t.defs,e=function(t){var n=(0,s.useState)([]),e=(0,a.Z)(n,2),r=e[0],o=e[1],u=(0,s.useCallback)((function(){var n=r.length+20;t.length>n?o(t.slice(0,n)):o((0,i.Z)(t))}),[r,20,o,t]);return(0,s.useEffect)((function(){u()}),[t]),{loaded:r,fetchNext:u}}(n),r=e.loaded,o=e.fetchNext;return(0,I.jsx)(v.Z,{children:(0,I.jsx)(M.Z,{dataLength:r.length,next:o,hasMore:r.length<n.length,loader:(0,I.jsx)(D,{}),children:(0,I.jsx)(x.ZP,{container:!0,spacing:2,children:r.map((function(t){return(0,I.jsx)(x.ZP,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,I.jsx)(q,{def:t})},t.id)}))})})})}var K=(0,C.ZP)(Z.Z)((function(t){var n=t.theme;return{marginTop:n.spacing(1),marginBottom:n.spacing(1),padding:n.spacing(1)}}));function Q(){var t=function(){var t=(0,w.TL)(),n=(0,w.CG)((function(t){return t.videos})),e=n.condition,r=e.tags,i=e.dateSpan,u=i.from,l=i.to,c=n.tagCandidates,d=(0,s.useCallback)((function(n){null===n?t(T.g.clearConditionDateFrom()):n instanceof k.ou?t(T.g.setConditionDateFrom(n.toMillis())):n instanceof Date?t(T.g.setConditionDateFrom(n)):console.error("from condition is not a date nor null",n)}),[t]),f=(0,s.useCallback)((function(n){null===n?t(T.g.clearConditionDateTo()):n instanceof k.ou?t(T.g.setConditionDateTo(n.toMillis())):n instanceof Date?t(T.g.setConditionDateTo(n)):console.error("to condition is not a date nor null",n)}),[t]),h=(0,s.useState)(),g=(0,a.Z)(h,2),p=g[0],m=g[1],v=(0,s.useCallback)((function(t){return(0,I.jsx)(b.Z,(0,o.Z)((0,o.Z)({},t),{},{label:"\u30bf\u30b0",variant:"standard"}))}),[]),x=(0,s.useCallback)((function(n,e,r){switch(r){case"reset":return t(T.g.addConditionTags([e])),void m("");case"clear":return void m("");case"input":return void m(e)}}),[m,t]);return{tags:r,from:null!==u?new Date(u):null,to:null!==l?new Date(l):null,tagCandidates:c,autocompleteValue:p,renderTagAutocompleteInput:v,onChangeFrom:d,onChangeTo:f,onChangeTag:x}}(),n=t.tags,e=t.from,r=t.to,i=t.tagCandidates,l=t.autocompleteValue,c=t.renderTagAutocompleteInput,d=t.onChangeFrom,f=t.onChangeTo,h=t.onChangeTag;return(0,I.jsx)(v.Z,{children:(0,I.jsxs)(K,{children:[(0,I.jsx)(u.Z,{variant:"caption",children:(0,I.jsx)(y.Z,{})}),(0,I.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,I.jsxs)(x.ZP,{item:!0,xs:12,children:[(0,I.jsx)(j.Z,{options:i,renderInput:c,autoHighlight:!0,autoSelect:!0,blurOnSelect:!0,clearOnBlur:!0,onInputChange:h,inputValue:l}),(0,I.jsx)(N,{tags:n,deletable:!0})]}),(0,I.jsxs)(x.ZP,{item:!0,xs:12,children:[(0,I.jsx)(A.O,{label:"\u914d\u4fe1\u30fb\u6295\u7a3f\u65e5(from)",inputFormat:"yyyy-MM-dd",value:e,onChange:d,renderInput:function(t){return(0,I.jsx)(b.Z,(0,o.Z)({},t))},clearable:!0}),(0,I.jsx)(A.O,{label:"\u914d\u4fe1\u30fb\u6295\u7a3f\u65e5(to)",inputFormat:"yyyy-MM-dd",value:r,onChange:f,renderInput:function(t){return(0,I.jsx)(b.Z,(0,o.Z)({},t))},clearable:!0})]})]})]})})}function R(){var t=function(){var t=(0,w.TL)(),n=(0,w.CG)((function(t){return t.videos})),e=n.list,r=n.condition,a=r.tags,o=r.dateSpan,u=o.from,l=o.to,c=0===e.length;(0,s.useEffect)((function(){c&&t(T.g.init())}),[e]);var d=(0,s.useMemo)((function(){return(0,i.Z)(e.filter((function(t){return(0===a.length||a.every((function(n){return t.tags.includes(n)})))&&(null===u||u<=t.publishedAt)&&(null===l||t.publishedAt<=l)}))).sort((function(t,n){return-(t.publishedAt-n.publishedAt)}))}),[e,a,u,l]);return{loading:c,defs:d}}(),n=t.loading,e=t.defs;return n?(0,I.jsx)(D,{}):(0,I.jsxs)(s.Fragment,{children:[(0,I.jsx)(Q,{}),(0,I.jsx)(J,{defs:e})]})}var X=e(33032),Y=e(84322),$=e.n(Y),tt=e(41441),nt=e(34013),et={id:"dummy",publishedAt:k.ou.fromISO("2014-09-07T00:00:00Z").toMillis(),title:"dummy",description:"no videos fetched",thumbnails:{default:{url:"dummy",width:120,height:90},medium:{url:"dummy",width:320,height:180},high:{url:"dummy",width:480,height:360}},tags:[]},rt=function(){var t=(0,X.Z)($().mark((function t(n){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Array.from(new Set(n.flatMap((function(t){return t.tags}))).keys()).sort());case 1:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),it=(0,tt.l)((function(t){return t.pipe((0,nt.h)(T.g.init.match),(0,w.vi)("videos/fetch",(0,X.Z)($().mark((function t(){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=T.g,t.next=3,fetch("".concat("/motty-fans","/assets/videos/videos.json")).then((function(t){return t.json()})).then((function(t){var n=t.items;return n&&n.length>0?n.map((function(t){return{id:t.id.videoId,publishedAt:k.ou.fromISO(t.snippet.publishedAt).toMillis(),title:t.snippet.title,description:t.snippet.description,thumbnails:t.snippet.thumbnails,tags:t.tags&&t.tags.length>0?(0,i.Z)(t.tags):["no tags"]}})):[et]})).catch((function(t){return[(0,o.Z)((0,o.Z)({},et),{},{description:t})]}));case 3:return t.t1=t.sent,t.abrupt("return",t.t0.setList.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})))))}),(function(t){return t.pipe((0,nt.h)(T.g.setList.match),(0,w.vi)("videos/tag-cadidates",function(){var t=(0,X.Z)($().mark((function t(n){var e;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.payload,t.t0=T.g,t.next=4,rt(e);case 4:return t.t1=t.sent,t.abrupt("return",t.t0.setTagCandidates.call(t.t0,t.t1));case 6:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()))}),(function(t){return t.pipe((0,nt.h)(T.g.init.match),(0,w.vi)("videos/default-condition",(0,X.Z)($().mark((function t(){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",T.g.setConditionDateFrom(k.ou.now().minus({months:3}).toMillis()));case 1:case"end":return t.stop()}}),t)})))))}));(0,r.mb)(it);var at=function(){return(0,I.jsx)(s.Suspense,{fallback:(0,I.jsx)(D,{}),children:(0,I.jsx)(R,{})})}}}]);
//# sourceMappingURL=videos.e88af388.chunk.js.map