import{q as f,d as R,r as _}from"./store-B39U2sUK.js";import{r as m,j as e,R as S}from"./jsx-runtime-_5WuVDLK.js";import{D as y}from"./datetime-BT3pVNmC.js";import{T as A,I as J,u as w,G as u,f as P,a as E,b as F,d as $}from"./base-D94wimd6.js";import{i as z,k as U,j as T,u as V,_ as O,b as g,c as G,h as N}from"./DefaultPropsProvider-Cd7czArd.js";import{P as b}from"./Paper-nIoFMWoM.js";import{C as W}from"./Container-ZEU60_wJ.js";import{c as C}from"./menu-defs-jy_HPXnl.js";import{u as q,a as I}from"./ducks-D0Wyj6xE.js";import{L as Q,T as l,a as Y}from"./ListItem-DPIJrQSi.js";import{T as K,D as X,a as Z,b as ee,c as M,d as h,e as se,A as ie,L as te}from"./TableRow-DHL9G5yA.js";import{I as ne}from"./IconButton-YPa5RDI0.js";import{L as re}from"./Link-C5O9j2aB.js";import{B as oe}from"./Box-_UgLl1y3.js";import{f as ae,w as le}from"./util-BN9zR8p4.js";import"./utils-BMjij2k7.js";import"./useTheme-gLwWT2hx.js";import"./TransitionGroupContext-DDXbBdsA.js";import"./index-CTAOeIM6.js";import"./useFormControl-gmeMoCWW.js";import"./useSlotProps-ARyd7VdJ.js";import"./Modal-C_0CZEdW.js";import"./Backdrop-CBRxG1rH.js";import"./GlobalStyles-Dcu5lQlt.js";import"./createBox-BG4Xlgkm.js";function ce(s){return z("MuiTableHead",s)}U("MuiTableHead",["root"]);const de=["className","component"],ue=s=>{const{classes:i}=s;return N({root:["root"]},ce,i)},he=T("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(s,i)=>i.root})({display:"table-header-group"}),me={variant:"head"},L="thead",xe=m.forwardRef(function(i,n){const t=V({props:i,name:"MuiTableHead"}),{className:r,component:c=L}=t,a=O(t,de),o=g({},t,{component:c}),d=ue(o);return e.jsx(K.Provider,{value:me,children:e.jsx(he,g({as:c,className:G(d.root,r),ref:n,role:c===L?null:"rowgroup",ownerState:o},a))})}),pe=C(e.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"}),"Link"),je=C(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),fe=["video","broadcast","short"];function be(s){return!!s&&fe.includes(s)}function ve(s){if(!be(s))return null;switch(s){case"video":return"動画";case"broadcast":return"生配信";case"short":return"ショート";default:throw Error(s)}}function H(){return e.jsx("div",{children:"Loading..."})}const k=s=>["★".repeat(s),"☆".repeat(5-s)].join("").trim();function B({thumbnail:{url:s,width:i,height:n},href:t,alt:r}){const c=w({xs:a=>({maxHeight:a.spacing(9)}),sm:a=>({maxHeight:a.spacing(9)}),md:a=>({maxHeight:a.spacing(6)}),lg:a=>({maxHeight:a.spacing(6)}),xl:a=>({maxHeight:a.spacing(6)})});return e.jsx(re,{href:t,sx:a=>({display:"flex",alignItems:"center",justifyContent:"center",...c(a)}),target:"_blank",rel:"noopener noreferrer",children:e.jsx(oe,{component:"img",alt:r,src:s,sx:a=>({aspectRatio:`${i} / ${n}`,width:"100%",height:"100%",objectFit:"contain",display:"block"})})})}function D(s){const i=s.map(ve);switch(i.length){case 0:return null;case 1:return i[0];default:return i.map(n=>n==null?void 0:n.slice(0,1)).join(" / ")}}function ge({id:s,platform:i,title:n,titleReleasedIn:t,styles:r,amount:c,masteryLevel:a,part1:o,remarks:d}){const x=m.useMemo(()=>D(r),[r]),p=m.useCallback(()=>e.jsxs(u,{container:!0,children:[e.jsx(u,{item:!0,xs:6,children:e.jsx(l,{children:x})}),e.jsx(u,{item:!0,xs:6,children:e.jsx(l,{children:k(a)})}),e.jsx(u,{item:!0,xs:6,children:e.jsx(l,{children:i})}),e.jsx(u,{item:!0,xs:6,children:e.jsxs(l,{children:["実況: ",(o==null?void 0:o.publishedIn)??"(未設定)"]})}),e.jsx(u,{item:!0,xs:6,children:e.jsxs(l,{children:["配信数: ",c]})}),e.jsx(u,{item:!0,xs:6,children:e.jsxs(l,{children:["発売: ",t??"(未設定)"]})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(l,{children:d})})]}),[c,a,o,i,d,t,x]);return e.jsx(Y,{secondaryAction:e.jsx(ne,{edge:"end",...o!==null?{href:o.url}:{},children:e.jsx(pe,{})}),children:e.jsxs(u,{container:!0,children:[e.jsx(u,{item:!0,xs:12,children:e.jsx(te,{primary:n})}),e.jsx(u,{item:!0,xs:4,children:o==null?null:e.jsx(B,{thumbnail:o.thumbnail,href:o.url,alt:o.title})}),e.jsx(u,{item:!0,xs:8,children:e.jsx(p,{})})]})},s)}function Le({defs:s}){return e.jsx(b,{children:e.jsx(Q,{sx:{width:"100%"},children:s.map(ge).flatMap((i,n)=>n===0?[i]:[e.jsx(X,{variant:"inset",component:"li",sx:{marginLeft:0}},`divider-${n}`),i])})})}function Se({id:s,platform:i,title:n,titleReleasedIn:t,styles:r,amount:c,masteryLevel:a,part1:o,remarks:d},x){const p=m.useMemo(()=>D(r),[r]),j=m.useCallback(()=>o?e.jsx(h,{align:"center",sx:v=>({padding:`${v.spacing(.5)} ${v.spacing(2)}`}),children:e.jsx(B,{thumbnail:o.thumbnail,alt:n,href:o.url})}):e.jsx(h,{align:"center",children:e.jsx(l,{children:"(未設定)"})}),[o,n]);return e.jsxs(M,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(h,{component:"th",scope:"row",align:"center",children:e.jsx(l,{children:x+1})}),e.jsx(j,{}),e.jsx(h,{align:"center",children:e.jsx(l,{children:i})}),e.jsx(h,{children:e.jsx(l,{children:n})}),e.jsx(h,{align:"center",children:e.jsx(l,{children:(o==null?void 0:o.publishedIn)??"(未設定)"})}),e.jsx(h,{align:"center",children:e.jsx(l,{children:t??"(未設定)"})}),e.jsx(h,{align:"center",children:e.jsx(l,{children:p})}),e.jsx(h,{align:"center",children:e.jsx(l,{children:c})}),e.jsx(h,{align:"center",children:e.jsx(l,{children:k(a)})}),e.jsx(h,{children:e.jsx(l,{children:d})})]},s)}function ye({defs:s}){return e.jsx(Z,{component:b,children:e.jsxs(ee,{"aria-label":"simple table",children:[e.jsx(xe,{children:e.jsx(M,{children:["#","Part 1.","機種","タイトル","実況年","発売年","実況形式","実況本数","やりこみ評価","備考"].map((i,n)=>e.jsx(h,{component:"th",scope:"row",align:"center",children:i},n))})}),e.jsx(se,{children:s.map(Se)})]})})}function we(){return e.jsx(ie,{position:"static",color:"primary",enableColorOnDark:!0,children:e.jsx(l,{variant:"subtitle1",children:"MOTTYのゲーム実況シリーズ一覧"})})}const Te=()=>{const{series:s}=I(t=>t.liveSeries),i=m.useMemo(()=>s.map(({id:t,game:r,seriesTitle:c,lives:a,remarks:o})=>({id:t,platform:r==null?void 0:r.platform,title:c,titleReleasedIn:(r==null?void 0:r.releasedIn)||null,styles:(d=>Array.from(d))(a.map(({liveStyle:d})=>d).reduce((d,x)=>d.add(x),new Set)),amount:a.length,masteryLevel:r==null?void 0:r.masteryLevel,part1:a.length===0?null:a.slice(0,1).map(({publishedAt:d,url:x,thumbnail:p,title:j})=>({publishedIn:y.fromMillis(d,{zone:"JST"}).year,url:x,thumbnail:p,title:j}))[0],remarks:o})),[s]);return{viewMode:w({xs:"list",sm:"list",md:"table",lg:"table",xl:"table"}),defs:i}};function Ce(){const{viewMode:s,defs:i}=Te(),n=m.useCallback(()=>{switch(s){case"list":return e.jsx(Le,{defs:i});case"table":return e.jsx(ye,{defs:i});default:throw s}},[s,i]);return e.jsxs(S.Fragment,{children:[e.jsx(we,{}),e.jsx(n,{})]})}const Ie=T(b)(({theme:s})=>({marginTop:s.spacing(1),marginBottom:s.spacing(1),padding:s.spacing(1)}));function Me(){return e.jsx(W,{children:e.jsx(Ie,{children:e.jsx(A,{id:"live-series-condition-input",label:"find",InputProps:{startAdornment:e.jsx(J,{position:"start",children:e.jsx(je,{})})},variant:"standard",fullWidth:!0})})})}const He=()=>{const[s,i]=m.useState(!1),n=q();m.useEffect(()=>{s||(n(f.init()),i(!0))},[s,i,n]);const{series:t}=I(c=>c.liveSeries);return{loading:m.useMemo(()=>!t||t.length===0,[t])}};function ke(){const{loading:s}=He();return s?e.jsx(H,{}):e.jsxs(S.Fragment,{children:[e.jsx(Me,{}),e.jsx(Ce,{})]})}function os(){return e.jsx(m.Suspense,{fallback:e.jsx(H,{}),children:e.jsx(ke,{})})}const Be=({id:{videoId:s},snippet:{description:i,publishedAt:n,title:t,thumbnails:r},liveSeriesId:c,liveStyle:a,tags:o},d,x)=>({id:s,description:i,publishedAt:y.fromISO(n).toMillis(),title:t,thumbnail:r.default,liveSeriesId:c,liveStyle:a,tags:(o==null?void 0:o.map($("none")))??[],url:`https://www.youtube.com/watch?v=${s}`});async function De(){const[s,i,n]=await Promise.all([(async()=>{const t=await P();return Object.groupBy(t.items.filter(({liveSeriesId:r})=>r!=null).map(Be),({liveSeriesId:r})=>r??(()=>{throw new Error("unexpected video record having no live-series id")})())})(),(async()=>(await E()).items)(),(async()=>{const t=await F();return new Map(t.items.map(r=>[r.id,r]))})()]);return i.map(t=>({...t,lives:t.id in s?s[t.id]??[]:[],game:t.gameId&&n.has(t.gameId)?n.get(t.gameId)??null:null}))}const Re=s=>s.pipe(ae(f.init.match),le("live-series/init",async()=>{const i=await De();return f.setSeries({series:i})})),_e=R(Re);_(_e);export{os as default};
